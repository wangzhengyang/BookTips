[toc]

#Linux安全性
用户权限通过创建用户时分配的用户ID(User ID，缩写为UID)来跟踪的。
## `/etc/passed`文件
root用户账号是Linux系统的管理员，固定分配给它的UID是0
`/etc/passwd`包括如下信息：
1. 登陆用户名
2. 用户密码
3. 用户账号的UID(数字形式)
4. 用户账号的组ID(GID)(数字形式)
5. 用户账户的文本描述(称为备注字段)
6. 用户HOME目录的位置
7. 用户的默认shell
## `/etc/shadow`文件
`/etc/shadow`文件为系统上的每个用户账号都保存了一条记录
`/etc/shadow`包括以下9个字段：
1. 与`/etc/passwd`文件中的登陆名字字段对应的登录名
2. 加密后的密码
3. 自上次修改密码后过去的天数密码(自1970年1月1日开始计算)
4. 多少天后才能更改密码
5. 多少天后必须更改密码
6. 密码过期前提前多少天提醒用户更改密码
7. 密码过期后多少天禁用用户账号
8. 用户账号被禁用的日期(用自1970年1月1日到当天的天数表示)
9. 预留字段给将来使用

## 添加新用户
系统默认值被设置在`/etc/default/useradd`文件中
使用`useradd -D`查看这些默认值，默认值如下：
1. 新用户会被添加到GID为100的公共组；
2. 新用户的HOME目录将会位于/home/loginname；
3. 新用户账号密码在过期后不会被禁用；
4. 新用户账号未被设置过期日期；
5. 新用户账号将bash shell作为默认shell；
6. 系统会将`/etc/skel`目录下的内容复制到用户的HOME目录下；
7. 系统为该用户账号在mail目录下创建一个用于接收邮件的文件；

|参数|描述|
|-|-|
|-c comment|给新用户添加备注|
|-d home_dir|为主目录指定一个名字(如果不想用登录名作为主目录名的话)|
|-e expire_date|用YYYY-MM-DD格式指定一个账户过期的日期|
|-f inactive_days|指定这个账户密码过期后多少天这个账号被禁用；O表示密码一过期就立即禁用，1表示禁用这个功能|
|-g initial_group|指定用户登陆组的GID或组名|
|-G group ...|指定用户除登陆组之外所属的一个或多个附加组|
|-k|必须和-m一起使用，将/etc/skel目录的内容复制到用户的HOME目录|
|-m|创建用户的HOME目录|
|-M|不创建用户的HOME目录(当默认设置里要求创建时才使用这个选项)|
|-n|创建一个与用户登录名同名的新组|
|-r|创建系统账号|
|-p passwd|为用户账号指定默认密码|
|-s shell|指定默认的登陆shell|
|-u uid|为账户指定唯一的UID|

可以直接修改系统默认的新用户设置
|参数|描述|
|-|-|
|-b default_home|更改默认的创建用户HOME目录的位置|
|-e expiration_date|更改默认的新账户的过期日期|
|-f inactive|更改默认的新用户从密码过期到账户被禁用的天数|
|-g group|更改默认的组名称或GID|
|-s shell|更改默认的登陆shell|
```bash
useradd -D -s /bin/tsch
```
## 删除用户
`userdel`只会删除`/etc/passwd`文件中的用户信息，而不会删除系统中属于该账号的任何文件
`-r`参数，`userdel`会删除用户的HOME目录以及邮件目录
## 修改用户
|命令|描述|
|-|-|
|usermod|修改用户账户的字段，还可以指定主要组以及附加组的所属关系|
|passwd|修改已有账户的密码|
|chpasswd|从文件中读取登陆名密码对，并更新密码|
|chage|修改密码的过期日期|
|chfn|修改用户账户的备注信息|
|chsh|修改用户账户的默认登陆shell|
### `usermod`
用来修改`/etc/passwd`文件中的大部分字段
|参数|描述|
|-|-|
|-c|修改备注字段|
|-e|修改过期日期|
|-g|修改默认的登陆组|
|-l|修改用户账号的登录名|
|-L|锁定账户，使用户无法登录|
|-p|修改账户的密码|
|-U|解除锁定，使用户能够登录|
### `passwd`和`chpasswd`
如果只用`passwd`命令，它会改自己的密码。系统上的任何用户都能改自己的密码，但只有root用户才能有权限该别人的密码
`-e`选项强制用户下次登陆时修改密码。可以给用户设置一个简单的密码，之后再强制在下次登陆时改成他们能记住的更复杂的密码
`chpasswd`命令从标准输入自动读取登录名和密码对(由冒号分割)列表，给密码加密，然后为用户账号设置
### `chsh`、`chfn`和`chage`
用来修改特定的账户信息
`chsh`用来快速修改默认的用户登录shell;使用时必须用shell的全路径名作为参数，不能只用shell名
`chfn`提供了在`/etc/passwd`文件的备注字段中存储信息的标准方法；通过`finger`命令可以方便地查看Linux系统上的用户信息；如果在使用`chfn`命令时没有参数，它会询问将哪些内容加进备注字段
`chage`用来帮助管理用户账号的有效期
|参数|描述|
|-|-|
|-d|设置上次修改密码到现在的天数|
|-E|设置密码过期的日期|
|-I|设置面膜过期到锁定账户的天数|
|-m|设置修改密码之间最少要多少天|
|-W|设置密码过期前多久开始出现提醒信息|
日期格式使用下面任意一种：
1. YYYY-MM-DD格式的日期
2. 代表从1970年1月1日起到该日期天数的数值

# Linux组
## `/etc/group`文件
`/etc/group`文件包含系统上用到的每个组的信息；系统账户用的组通常会分配低于500的GID，而用户组的GID则会从500开始分配，`/etc/group`文件有4个字段：
1. 组名
2. 组密码
3. GID
4. 属于该组的用户列表

## 创建新组
`groupadd`命令在系统上创建新组
```bash
groupadd name
```
创建新组时，默认没有用户被分配到该组
通过`usermod`命令 `-G`选项添加用户
```bash
usermod -G group user
```
## 修改组
`groupmod`可以修改已有组的GID(加`-g`选项)或组名(加`-n`选项)
```bash
groupmod -n new old
```


